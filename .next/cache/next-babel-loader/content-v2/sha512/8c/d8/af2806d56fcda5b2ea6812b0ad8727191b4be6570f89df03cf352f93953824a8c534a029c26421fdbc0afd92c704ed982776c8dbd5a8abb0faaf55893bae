{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\Wait for magic\\\\Documents\\\\GitHub\\\\whatsapp-clone-with-nextjs\\\\components\\\\ChatScreen.js\";\nimport { Avatar, IconButton } from '@material-ui/core';\nimport { useRouter } from 'next/router';\nimport React, { useState } from 'react';\nimport { useAuthState } from 'react-firebase-hooks/auth';\nimport styled from 'styled-components';\nimport { auth, db } from '../firebase';\nimport AttachFileIcon from '@material-ui/icons/AttachFile';\nimport MoreVertIcon from \"@material-ui/icons/MoreVert\";\nimport { useCollection } from 'react-firebase-hooks/firestore';\nimport Message from './Message';\nimport InsertEmoticonIcon from '@material-ui/icons/InsertEmoticon';\nimport MicIcon from '@material-ui/icons/Mic';\nimport firebase from 'firebase';\n\nfunction ChatScreen({\n  chat,\n  messages\n}) {\n  const [user] = useAuthState(auth);\n  const router = useRouter();\n  const {\n    0: input,\n    1: setInput\n  } = useState(\"\");\n  const [messagesSnapshot] = useCollection(db.collection('chats').doc(router.query.id).collection(\"messages\").orderBy(\"timestamp\", \"asc\"));\n\n  const showMessage = () => {\n    console.log(messagesSnapshot);\n\n    if (messagesSnapshot) {\n      console.log(messagesSnapshot);\n      return messagesSnapshot.docs.map(message => {\n        console.log(message); //   <Message key={message.id} user={message.data().user}\n        //         message={{\n        //             ...message.data(),\n        //             timestamp: message.data().timestamp.toDate().getTime()\n        //         }}\n        //     />\n      });\n    } else {\n      //  console.log(messagesSnapshot);\n      console.log(messages);\n      return JSON.parse(messages).map(message => {\n        /*#__PURE__*/\n        _jsxDEV(Message, {\n          user: message.user,\n          message: message\n        }, message.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 41,\n          columnNumber: 18\n        }, this);\n      });\n    }\n  };\n\n  const sendMessage = e => {\n    e.preventDefault();\n    db.collection('users').doc(user.uid).set({\n      lastSeen: firebase.firestore.FieldValue.serverTimestamp()\n    }, {\n      merge: true\n    });\n    db.collection('chats').doc(router.query.id).collection('messages').add({\n      timestamp: firebase.firestore.FieldValue.serverTimestamp(),\n      message: input,\n      user: user.email,\n      photoURL: user.photoURL\n    });\n    setInput(\"\");\n  };\n\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: [/*#__PURE__*/_jsxDEV(Header, {\n      children: [/*#__PURE__*/_jsxDEV(Avatar, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(HeaderInformation, {\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \" RecipientEmail\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Last Seen\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(HeaderIcons, {\n        children: /*#__PURE__*/_jsxDEV(IconButton, {\n          children: [/*#__PURE__*/_jsxDEV(AttachFileIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 73,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(MoreVertIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 74,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(MessageContainer, {\n      className: \"h-screen p-8 bg-red-100\",\n      children: showMessage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(InputContainer, {\n      children: [/*#__PURE__*/_jsxDEV(InsertEmoticonIcon, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Input, {\n        value: input,\n        onChange: e => setInput(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        disabled: !input,\n        onClick: sendMessage,\n        children: \"Send\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 18\n      }, this), /*#__PURE__*/_jsxDEV(MicIcon, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 9\n  }, this);\n}\n\nexport default ChatScreen;\nconst Container = styled.div.attrs({\n  className: \"h-screen\"\n})``;\nconst Header = styled.div.attrs({\n  className: \"sticky bg-white z-100 top-0 flex p-2 h-16 items-center border-b-2 border-gray-200\"\n})``;\nconst HeaderInformation = styled.div.attrs({\n  className: \"m-2 flex-1\"\n})``;\nconst HeaderIcons = styled.div.attrs({})``;\nconst MessageContainer = styled.div.attrs({})``;\nconst InputContainer = styled.div.attrs({\n  className: \"flex items-center p-3 sticky bottom-0 bg-white z-50\"\n})``;\nconst Input = styled.input.attrs({\n  className: \"flex-1 outline-none border-none rounded-xl bg-gray-50 p-2 ml-4 mr-4\"\n})``;","map":{"version":3,"sources":["C:/Users/Wait for magic/Documents/GitHub/whatsapp-clone-with-nextjs/components/ChatScreen.js"],"names":["Avatar","IconButton","useRouter","React","useState","useAuthState","styled","auth","db","AttachFileIcon","MoreVertIcon","useCollection","Message","InsertEmoticonIcon","MicIcon","firebase","ChatScreen","chat","messages","user","router","input","setInput","messagesSnapshot","collection","doc","query","id","orderBy","showMessage","console","log","docs","map","message","JSON","parse","sendMessage","e","preventDefault","uid","set","lastSeen","firestore","FieldValue","serverTimestamp","merge","add","timestamp","email","photoURL","target","value","Container","div","attrs","className","Header","HeaderInformation","HeaderIcons","MessageContainer","InputContainer","Input"],"mappings":"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","sourcesContent":["import { Avatar, IconButton } from '@material-ui/core'\r\nimport { useRouter } from 'next/router'\r\nimport React, { useState } from 'react'\r\nimport { useAuthState } from 'react-firebase-hooks/auth'\r\nimport styled from 'styled-components'\r\nimport { auth, db } from '../firebase'\r\nimport AttachFileIcon from '@material-ui/icons/AttachFile'\r\nimport MoreVertIcon from \"@material-ui/icons/MoreVert\";\r\nimport { useCollection } from 'react-firebase-hooks/firestore'\r\nimport Message from './Message'\r\nimport InsertEmoticonIcon from '@material-ui/icons/InsertEmoticon'\r\nimport MicIcon from '@material-ui/icons/Mic'\r\nimport firebase from 'firebase'\r\nfunction ChatScreen({ chat, messages }) {\r\n    \r\n    const [user] = useAuthState(auth)\r\n  \r\n    const router = useRouter();\r\n    const [input, setInput] = useState(\"\")\r\n    const [messagesSnapshot]=useCollection(db.collection('chats').doc(router.query.id).collection(\"messages\").orderBy(\"timestamp\", \"asc\"))\r\n    const showMessage = () => {\r\n         console.log(messagesSnapshot);\r\n        \r\n        if (messagesSnapshot) {\r\n         console.log(messagesSnapshot);\r\n            \r\n            return messagesSnapshot.docs.map((message) => {\r\n                console.log(message);\r\n            //   <Message key={message.id} user={message.data().user}\r\n            //         message={{\r\n            //             ...message.data(),\r\n            //             timestamp: message.data().timestamp.toDate().getTime()\r\n            //         }}\r\n            //     />\r\n            })\r\n        } else {\r\n        //  console.log(messagesSnapshot);\r\n\r\n            console.log(messages);\r\n            return JSON.parse(messages).map((message) => {\r\n                 <Message\r\n                    key={message.id}\r\n                    user={message.user}\r\n                    message={message}\r\n                  />\r\n            })\r\n        }\r\n    }\r\n    const sendMessage = (e) => {\r\n        e.preventDefault();\r\n        db.collection('users').doc(user.uid).set({\r\n            lastSeen: firebase.firestore.FieldValue.serverTimestamp(),\r\n        }, { merge: true }\r\n        )\r\n        db.collection('chats').doc(router.query.id).collection('messages').add({\r\n            timestamp: firebase.firestore.FieldValue.serverTimestamp(),\r\n            message: input,\r\n            user: user.email,\r\n            photoURL: user.photoURL\r\n        })\r\n        setInput(\"\");\r\n    }\r\n    return (\r\n        <Container>\r\n            <Header>\r\n                <Avatar />\r\n                <HeaderInformation>\r\n                    <h3> RecipientEmail</h3>\r\n                    <p>Last Seen</p>\r\n                </HeaderInformation>\r\n                <HeaderIcons>\r\n                    <IconButton>\r\n                        <AttachFileIcon />\r\n                        <MoreVertIcon/>\r\n                    </IconButton>\r\n                </HeaderIcons>\r\n            </Header>\r\n            <MessageContainer className=\"h-screen p-8 bg-red-100\">\r\n                {showMessage}\r\n                {/* <Message/> */}\r\n                {/* <EndOfMessage/> */}\r\n            </MessageContainer>\r\n            <InputContainer>\r\n                <InsertEmoticonIcon />\r\n                <Input value={input} onChange={e => setInput(e.target.value)} />\r\n                 <button disabled={!input} onClick={sendMessage}>Send</button>\r\n                <MicIcon/>\r\n            </InputContainer>\r\n        </Container>\r\n    )\r\n}\r\n\r\nexport default ChatScreen\r\n\r\nconst Container = styled.div.attrs({\r\n    className:\"h-screen\"\r\n})``;\r\n\r\nconst Header = styled.div.attrs({\r\n    className:\"sticky bg-white z-100 top-0 flex p-2 h-16 items-center border-b-2 border-gray-200\"\r\n})``\r\nconst HeaderInformation = styled.div.attrs({\r\nclassName:\"m-2 flex-1\" \r\n})``;\r\nconst HeaderIcons = styled.div.attrs({})``;\r\nconst MessageContainer = styled.div.attrs({\r\n    \r\n})``;\r\nconst InputContainer = styled.div.attrs({\r\n\r\n     className:\"flex items-center p-3 sticky bottom-0 bg-white z-50\",\r\n})``;\r\nconst Input = styled.input.attrs({\r\n    className:\"flex-1 outline-none border-none rounded-xl bg-gray-50 p-2 ml-4 mr-4\",\r\n})``;\r\n"]},"metadata":{},"sourceType":"module"}